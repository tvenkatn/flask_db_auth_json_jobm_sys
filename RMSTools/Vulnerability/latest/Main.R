#Developed by Mohammad Razavi June-2016

rm(list=ls())
cat("\014")
cat("\n")
c=Sys.time()

# Data Entry from the Batch file
userArgs <- commandArgs(trailingOnly = TRUE)

if (length(userArgs)>0) {
  currdir <-userArgs[1]
  progdir <-userArgs[2]
} else {
  currdir <-"D:\\Test\\Vuln_Data_Validation"
  progdir <-"D:\\Test\\MDValidation\\Vulnerability\\latest"
}

#---  Create \log folder if not present --------------------
logdir = paste0(currdir,"/log")
if (!(file.exists(logdir))) {
  dir.create(logdir)
}

setwd(currdir)

source("//ca1ntap01/grm/APPLICS/EngTools/R_packages/Library/R_Utilities.R")

RMS_load_packages(c("rjson","yaml", "data.table","RODBC","sqldf","knitr","gridExtra","xtable","plyr"))

cwd <- getwd()
options(warn=-1)

sets <- RMS_readJSON(paste0(progdir,"/data"),"settings.json")
CFG <-  RMS_readJSON(paste0(currdir),"config.json")

knit2html(paste0(progdir,'/Main.Rmd'),paste0(currdir,'/log/Main.html'))

options(warn=0)
library(xtable)
library(data.table)

#browseURL(paste0(getwd(),"/log/Main.html"))
source(paste0(progdir,'/modules/TableofContent.r'))
