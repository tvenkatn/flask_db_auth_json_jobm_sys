Test_0 <- function (dbHandle,reportCon) {
# Import all tables from the sql database
tables <- sqlTables(dbHandle, schema - dbo) # import all database tables names 
tables = data.table(tables)
imaptables=tolower(tables[like(tolower(TABLE_NAME),"vcc")]$TABLE_NAME)
perilcountry=gsub("vcc","",imaptables)
perilcountry = perilcountry[!(perilcountry %in% sets$Test0$Peril_Country_Exclude)]
if (length(CFG$Perils)!=0) {Perils <- CFG$Perils}
else {
  Perils <- unique(substring(tables[like(tolower(TABLE_NAME),"vcc") & tolower(TABLE_NAME)!="vcc"]$TABLE_NAME,1,5))
  Perils[substring(Perils,3,5)!="cas"]=substring(Perils,1,2)
  Perils=Perils[Perils !="ac"]}
  Perils=tolower(unique(Perils))

  if (length(CFG$Countries)!=0) {Countries <- CFG$Countries}
else { Countries <- tolower(unique(substrRight(tables[like(tolower(TABLE_NAME),"vcc") & tolower(TABLE_NAME)!="vcc"]$TABLE_NAME,2)))}

if (length(Perils)==0){
  cat(paste0('DATABASE DOES NOT INCLUDE RISKLINK TABLES!','\n'))
  RiskLinkTableExist<- FALSE
   } else {
     RiskLinkTableExist<- TRUE
  cat(paste0('\t','\t',"List of countries:")) 
  cat(paste(toupper(Countries), collapse="," )) 
  cat('\n') 
  cat(paste0('\t','\t',"List of perils:")) 
  cat(paste(toupper(Perils), collapse=',')) 
  cat(paste0("\n",'\t','\t','Database includes risklink tables.'))   
  }

if ("vcc" %in% tables$TABLE_NAME){
  cat(paste0("\n",'\t','\t','Database includes HD tables.')) 
  NGTableExist<-TRUE
    } else {
  cat(paste0("\n",'\t','\t','Database does not include HD tables.')) 
  NGTableExist<-FALSE
    }
return(list('perilcountry'=perilcountry,'Peril' = Perils,'Country' = Countries,'RLTableExtst' = RiskLinkTableExist,'NGTableExist'=NGTableExist))
}

Test_0Out=Test_0(dbHandle,reportCon)
Perils=Test_0Out$Peril
Countries=Test_0Out$Country
RiskLinkTableExist=Test_0Out$RLTableExtst
NGTableExist=Test_0Out$NGTableExist
perilcountry=Test_0Out$perilcountry
