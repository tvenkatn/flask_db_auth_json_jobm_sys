<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>LIST OF TESTS</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>





<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>#Mohammad Razavi June-2016</p>

<h4>LIST OF TESTS</h4>

<p>rm(list=ls())
cat(&ldquo;\014&rdquo;)
c=Sys.time()
library(yaml)
library(RODBC) 
library(data.table)
require(sqldf)
library(knitr)
require(knitr)
knit2html(&ldquo;mkdTest.rmd&rdquo;)</p>

<p>setwd(&ldquo;D://Vulnerability//Vuln_DataLevel_CheckTool_NAEQ&rdquo;)
input = yaml.load_file(&ldquo;input.yml&rdquo;)
unlink(paste0(input$workdirectory,&ldquo;VulnFiles&rdquo;),force=T,recursive=T)  ###deleting old Vulnfiles</p>

<p>dir&lt;-input$workdirectory
setwd(dir)</p>

<p>input_backup &lt;- list.files(path=&ldquo;.&rdquo;, &ldquo;input.yml&rdquo;, full.names = TRUE)
file.copy(input_backup,paste0(input$workdirectory,&ldquo;VulnFiles&rdquo;))
outdir&lt;-paste0(input$workdirectory,&ldquo;VulnFiles&rdquo;, sep=&ldquo;&rdquo;)
Vulndir = input$Vulndir
Country = input$Country
subperil =input$subperil</p>

<p>dbHandle &lt;- odbcDriverConnect(paste(&ldquo;driver={SQL Server};
                                    server=&rdquo;,input$servername, &ldquo;;
                                    database=&rdquo;, input$VulnCacheDatabase, &ldquo;;
                                    trusted_connection=true&rdquo;, sep=&ldquo;&rdquo;))</p>

<p>dbHandle2 &lt;- odbcDriverConnect(paste(&ldquo;driver={SQL Server};
                                    server=&rdquo;,input$servername, &ldquo;;
                                    database=&rdquo;, input$NGgeographyData, &ldquo;;
                                    trusted_connection=true&rdquo;, sep=&ldquo;&rdquo;))</p>

<h1>Create the report file</h1>

<p>if (file.exists(paste0(dir,&ldquo;/log&rdquo;))) {
  # unlink(&ldquo;log&rdquo;,force=T)
  #shell(&ldquo;rd&rdquo;,&ldquo;log&rdquo;)
} else {dir.create(file.path(directory, &ldquo;log&rdquo;), showWarnings = FALSE)}</p>

<p>setwd(paste0(dir,&ldquo;/log&rdquo;))</p>

<p>unlink(&ldquo;Report.txt&rdquo;)</p>

<h2>1. HazCache Data Level Check: Checking missing tables</h2>

<p>sink(&ldquo;Report.txt&rdquo;)</p>

<pre><code>## Error in eval(expr, envir, enclos): could not find function &quot;sqlTables&quot;
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): could not find function &quot;data.table&quot;
</code></pre>

<pre><code>## Error in match(x, table, nomatch = 0L): object &#39;tables&#39; not found
</code></pre>

<pre><code>## TEST2: EMPTY TABLES:
</code></pre>

<pre><code>## Error: could not find function &quot;sqlQuery&quot;
</code></pre>

<h1>Import and Database tables in R</h1>

<p>vcc = sqlQuery(dbHandle, &ldquo;select * From vcc&rdquo;)
eqvccus = sqlQuery(dbHandle, &ldquo;select * From eqvccus&rdquo;)
vocc = sqlQuery(dbHandle, &ldquo;select * From vocc&rdquo;)
eqvoccus = sqlQuery(dbHandle, &ldquo;select * From eqvoccus&rdquo;)
imap = sqlQuery(dbHandle, &ldquo;select * From imap&rdquo;)
eqimapus = sqlQuery(dbHandle, &ldquo;select * From eqimapus&rdquo;)
vinv = sqlQuery(dbHandle, &ldquo;select * From vinv&rdquo;)
eqvinvus = sqlQuery(dbHandle, &ldquo;select * From eqvinvus&rdquo;)
vgeo = sqlQuery(dbHandle, &ldquo;select * From vgeo&rdquo;)
eqvgeous = sqlQuery(dbHandle, &ldquo;select * From eqvgeous&rdquo;)
cghs = sqlQuery(dbHandle, paste0(&ldquo;select * From cghs&rdquo;))
eqcghsus = sqlQuery(dbHandle, paste0(&ldquo;select * From eqcghsus&rdquo;))
vds= sqlQuery(dbHandle, &ldquo;select * From vds&rdquo;)
eqvdsus= sqlQuery(dbHandle, &ldquo;select * From eqvdsus&rdquo;)
vhsr = sqlQuery(dbHandle, &ldquo;select * From vhsr&rdquo;)
eqvhsrus = sqlQuery(dbHandle, &ldquo;select * From eqvhsrus&rdquo;)
vbi = sqlQuery(dbHandle, &ldquo;select * From vbi&rdquo;)
eqvbius = sqlQuery(dbHandle, &ldquo;select * From eqvbius&rdquo;)
vbimod= sqlQuery(dbHandle, &ldquo;select * From vbimod&rdquo;)
eqvbimodus= sqlQuery(dbHandle, &ldquo;select * From eqvbimodus&rdquo;)
vparam = sqlQuery(dbHandle, &ldquo;select * From vparam&rdquo;)
eqvparamus = sqlQuery(dbHandle, &ldquo;select * From eqvparamus&rdquo;)
vlif= sqlQuery(dbHandle, &ldquo;select * From vlif&rdquo;)
eqvlifus= sqlQuery(dbHandle, &ldquo;select * From eqvlifus&rdquo;)
vll= sqlQuery(dbHandle, &ldquo;select * From vll&rdquo;)
eqvllus= sqlQuery(dbHandle, &ldquo;select * From eqvllus&rdquo;)
vdc0 = sqlQuery(dbHandle, &ldquo;select * From vdc0&rdquo;)
eqvdc0us = sqlQuery(dbHandle, &ldquo;select * From eqvdc0us&rdquo;)
mdsc = sqlQuery(dbHandle, &ldquo;select * From mdsc&rdquo;)
eqmdscus = sqlQuery(dbHandle, &ldquo;select * From eqmdscus&rdquo;)
odsc = sqlQuery(dbHandle, &ldquo;select * From odsc&rdquo;)
eqodscus = sqlQuery(dbHandle, &ldquo;select * From eqodscus&rdquo;)
vcv = sqlQuery(dbHandle, &ldquo;select * From vcv&rdquo;)
eqvcvus = sqlQuery(dbHandle, &ldquo;select * From eqvcvus&rdquo;)
fliinv = sqlQuery(dbHandle, &ldquo;select * From fliinv&rdquo;)
eqfliinvus = sqlQuery(dbHandle, &ldquo;select * From eqfliinvus&rdquo;)
LandMDR= sqlQuery(dbHandle, &ldquo;select * From LandMDR&rdquo;)
eqLandMDRus = sqlQuery(dbHandle, &ldquo;select * From eqLandMDRus&rdquo;)
LiqMDR = sqlQuery(dbHandle, &ldquo;select * From LiqMDR&rdquo;)
eqLiqMDRus = sqlQuery(dbHandle, &ldquo;select * From eqLiqMDRus&rdquo;)
vbrdr = sqlQuery(dbHandle, &ldquo;select * From vbrdr&rdquo;)
eqvbrdrus = sqlQuery(dbHandle, &ldquo;select * From eqvbrdrus&rdquo;)
vbrtv = sqlQuery(dbHandle, &ldquo;select * From vbrtv&rdquo;)
eqvbrtvus = sqlQuery(dbHandle, &ldquo;select * From eqvbrtvus&rdquo;)
vinvaghaz = sqlQuery(dbHandle, &ldquo;select * From vinvaghaz&rdquo;)
eqvinvaghazus = sqlQuery(dbHandle, &ldquo;select * From eqvinvaghazus&rdquo;)
vlifelinebi = sqlQuery(dbHandle, &ldquo;select * From vlifelinebi&rdquo;)
eqvlifelinebius = sqlQuery(dbHandle, &ldquo;select * From eqvlifelinebius&rdquo;)
vlifelinebidc = sqlQuery(dbHandle, &ldquo;select * From vlifelinebidc&rdquo;)
eqvlifelinebidcus = sqlQuery(dbHandle, &ldquo;select * From eqvlifelinebidcus&rdquo;)
vrs = sqlQuery(dbHandle, &ldquo;select * From vrs&rdquo;)
eqvrsus = sqlQuery(dbHandle, &ldquo;select * From eqvrsus&rdquo;)
vvrggeo = sqlQuery(dbHandle, &ldquo;select * From vvrggeo&rdquo;)
eqvvrggeous = sqlQuery(dbHandle, &ldquo;select * From eqvvrggeous&rdquo;)
eqvhazus = sqlQuery(dbHandle, &ldquo;select * From eqvhazus&rdquo;)
Map_DCKey = sqlQuery(dbHandle, &ldquo;select * From Map_DCKey&rdquo;)</p>

<p>#Import Mapping Tables </p>

<p>Map_Coverage = sqlQuery(dbHandle, &ldquo;select * From Map_Coverage&rdquo;)
Map_HazardScale = sqlQuery(dbHandle, &ldquo;select * From Map_HazardScale&rdquo;)
Map_HazardType = sqlQuery(dbHandle, &ldquo;select * From Map_HazardType&rdquo;)</p>

<p>#odbcClose(dbHandle)</p>

<h1>data.table:  Fast aggregation of large data (e.g. 100GB in RAM), fast ordered joins, fast add/modify/delete of columns by group using no copies at all, list columns and a fast file reader (fread). Offers a natural and flexible syntax, for faster development.</h1>

<p>vcc =data.table(vcc)
eqvccus = data.table(eqvccus)
vocc = data.table(vocc)
eqvoccus = data.table(eqvoccus)
imap = data.table(imap)
eqimapus = data.table(eqimapus)
vinv =data.table(vinv)
eqvinvus = data.table(eqvinvus)
vgeo =data.table(vgeo)
eqvgeous = data.table(eqvgeous)
cghs =data.table(cghs)
eqcghsus =data.table(eqcghsus)
vds= data.table(vds)
eqvdsus= data.table(eqvdsus)
vhsr = data.table(vhsr)
eqvhsrus = data.table(eqvhsrus)
vbi = data.table(vbi)
eqvbius = data.table(eqvbius)
vbimod= data.table(vbimod)
eqvbimodus= data.table(eqvbimodus)
vparam = data.table(vparam)
eqvparamus = data.table(eqvparamus)
vlif= data.table(vlif)
eqvlifus= data.table(eqvlifus)
vll= data.table(vll)
eqvllus= data.table(eqvllus)
vdc0 = data.table(vdc0)
eqvdc0us = data.table(eqvdc0us)
mdsc = data.table(mdsc)
eqmdscus = data.table(eqmdscus)
odsc =data.table(odsc)
eqodscus = data.table(eqodscus)
vcv = data.table(vcv)
eqvcvus = data.table(eqvcvus)
fliinv = data.table(fliinv)
eqfliinvus =data.table(eqfliinvus)
LandMDR= data.table(LandMDR)
eqLandMDRus = data.table(eqLandMDRus)
LiqMDR = data.table(LiqMDR)
eqLiqMDRus = data.table(eqLiqMDRus)
vbrdr = data.table(vbrdr)
eqvbrdrus = data.table(eqvbrdrus)
vbrtv = data.table(vbrtv)
eqvbrtvus =data.table(eqvbrtvus)
vinvaghaz =data.table(vinvaghaz)
eqvinvaghazus = data.table(eqvinvaghazus)
vlifelinebi = data.table(vlifelinebi)
eqvlifelinebius = data.table(eqvlifelinebius)
vlifelinebidc = data.table(vlifelinebidc)
eqvlifelinebidcus = data.table(eqvlifelinebidcus)
vrs = data.table(vrs)
eqvrsus = data.table(eqvrsus)
vvrggeo = data.table(vvrggeo)
eqvvrggeous = data.table(eqvvrggeous)
eqvhazus= data.table(eqvhazus)
Map_DCKey= data.table(Map_DCKey)</p>

<p>print(&ldquo;Finished reading Vulncache&rdquo; )</p>

<h1>Compare number of rows in various tables :</h1>

<p>cat(paste0(&ldquo;Compare number of rows in various tables :&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<p>nvll= nrow(vll)
neqvllus= nrow(eqvllus)
if (nvll!=neqvllus){
  cat(paste0(&ldquo;<strong><em>Number of records in vll is not equal to eqvllus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vll is  equal to eqvllus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>ncghs= nrow(cghs)
neqcghsus= nrow(eqcghsus)
if (ncghs!=neqcghsus){
  cat(paste0(&ldquo;<strong><em>Number of records in cghs is not equal to eqcghsus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in cghs is  equal to eqcghsus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nfliinv= nrow(fliinv)
neqfliinvus= nrow(eqfliinvus)
if (nfliinv!=neqfliinvus){
  cat(paste0(&ldquo;<strong><em>Number of records in fliinv is not equal to eqfliinvus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in fliinv is  equal to eqfliinvus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nimap= nrow(imap)
neqimapus= nrow(eqimapus)
if (nimap!=neqimapus){
  cat(paste0(&ldquo;<strong><em>Number of records in imap is not equal to eqimapus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in imap is  equal to eqimapus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nLandMDR= nrow(LandMDR)
neqLandMDRus= nrow(eqLandMDRus)
if (nLandMDR!=neqLandMDRus){
  cat(paste0(&ldquo;<strong><em>Number of records in LandMDR is not equal to eqLandMDRus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in LandMDR is  equal to eqLandMDRus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nLiqMDR= nrow(LiqMDR)
neqLiqMDRus= nrow(eqLiqMDRus)
if (nLiqMDR!=neqLiqMDRus){
  cat(paste0(&ldquo;<strong><em>Number of records in LiqMDR is not equal to eqLiqMDRus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in LiqMDR is  equal to eqLiqMDRus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nmdsc= nrow(mdsc)
neqmdscus= nrow(eqmdscus)
if (nmdsc!=neqmdscus){
  cat(paste0(&ldquo;<strong><em>Number of records in mdsc is not equal to eqmdscus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in mdsc is  equal to eqmdscus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nodsc= nrow(odsc)
neqodscus= nrow(eqodscus)
if (nodsc!=neqodscus){
  cat(paste0(&ldquo;<strong><em>Number of records in odsc is not equal to eqodscus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in odsc is  equal to eqodscus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvbi= nrow(vbi)
neqvbius= nrow(eqvbius)
if (nvbi!=neqvbius){
  cat(paste0(&ldquo;<strong><em>Number of records in vbi is not equal to eqvbius</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vbi is  equal to eqvbius&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvbimod= nrow(vbimod)
neqvbimodus= nrow(eqvbimodus)
if (nvbimod!=neqvbimodus){
  cat(paste0(&ldquo;<strong><em>Number of records in vbimod is not equal to eqvbimodus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vbimod is  equal to eqvbimodus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvbrdr= nrow(vbrdr)
neqvbrdrus= nrow(eqvbrdrus)
if (nvbrdr!=neqvbrdrus){
  cat(paste0(&ldquo;<strong><em>Number of records in vbrdr is not equal to eqvbrdrus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vbrdr is  equal to eqvbrdrus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvbrtv= nrow(vbrtv)
neqvbrtvus= nrow(eqvbrtvus)
if (nvbrtv!=neqvbrtvus){
  cat(paste0(&ldquo;<strong><em>Number of records in vbrtv is not equal to eqvbrtvus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vbrtv is  equal to eqvbrtvus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvcc= nrow(vcc)
neqvccus= nrow(eqvccus)
if (nvcc!=neqvccus){
  cat(paste0(&ldquo;<strong><em>Number of records in vcc is not equal to eqvccus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vcc is  equal to eqvccus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvcv= nrow(vcv)
neqvcvus= nrow(eqvcvus)
if (nvcv!=neqvcvus){
  cat(paste0(&ldquo;<strong><em>Number of records in vcv is not equal to eqvcvus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vcv is  equal to eqvcvus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvdc0= nrow(vdc0)
neqvdc0us= nrow(eqvdc0us)
if (nvdc0!=neqvdc0us){
  cat(paste0(&ldquo;<strong><em>Number of records in vdc0 is not equal to eqvdc0us</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vdc0 is  equal to eqvdc0us&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvds= nrow(vds)
neqvdsus= nrow(eqvdsus)
if (nvds!=neqvdsus){
  cat(paste0(&ldquo;<strong><em>Number of records in vds is not equal to eqvdsus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vds is  equal to eqvdsus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvgeo= nrow(vgeo)
neqvgeous= nrow(eqvgeous)
if (nvgeo!=neqvgeous){
  cat(paste0(&ldquo;<strong><em>Number of records in vgeo is not equal to eqvgeous</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vgeo is  equal to eqvgeous&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvcc= nrow(vcc)
neqvccus= nrow(eqvccus)
if (nvcc!=neqvccus){
  cat(paste0(&ldquo;<strong><em>Number of records in vcc is not equal to eqvccus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vcc is  equal to eqvccus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvhsr= nrow(vhsr)
neqvhsrus= nrow(eqvhsrus)
if (nvhsr!=neqvhsrus){
  cat(paste0(&ldquo;<strong><em>Number of records in vhsr is not equal to eqvhsrus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vhsr is  equal to eqvhsrus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvinv= nrow(vinv)
neqvinvus= nrow(eqvinvus)
if (nvinv!=neqvinvus){
  cat(paste0(&ldquo;<strong><em>Number of records in vinv is not equal to eqvinvus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vinv is  equal to eqvinvus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvinvaghaz= nrow(vinvaghaz)
neqvinvaghazus= nrow(eqvinvaghazus)
if (nvinvaghaz!=neqvinvaghazus){
  cat(paste0(&ldquo;<strong><em>Number of records in vinvaghaz is not equal to eqvinvaghazus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vinvaghaz is  equal to eqvinvaghazus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvlif= nrow(vlif)
neqvlifus= nrow(eqvlifus)
if (nvlif!=neqvlifus){
  cat(paste0(&ldquo;<strong><em>Number of records in vlif is not equal to eqvlifus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vlif is  equal to eqvlifus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvlifelinebi= nrow(vlifelinebi)
neqvlifelinebius= nrow(eqvlifelinebius)
if (nvlifelinebi!=neqvlifelinebius){
  cat(paste0(&ldquo;<strong><em>Number of records in vlifelinebi is not equal to eqvlifelinebius</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vlifelinebi is  equal to eqvlifelinebius&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvlifelinebidc= nrow(vlifelinebidc)
neqvlifelinebidcus= nrow(eqvlifelinebidcus)
if (nvlifelinebidc!=neqvlifelinebidcus){
  cat(paste0(&ldquo;<strong><em>Number of records in vlifelinebidc is not equal to eqvlifelinebidcus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vlifelinebidc is  equal to eqvlifelinebidcus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvocc= nrow(vocc)
neqvoccus= nrow(eqvoccus)
if (nvocc!=neqvoccus){
  cat(paste0(&ldquo;<strong><em>Number of records in vocc is not equal to eqvoccus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vocc is  equal to eqvoccus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvparam= nrow(vparam)
neqvparamus= nrow(eqvparamus)
if (nvparam!=neqvparamus){
  cat(paste0(&ldquo;<strong><em>Number of records in vparam is not equal to eqvparamus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vparam is  equal to eqvparamus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvrs= nrow(vrs)
neqvrsus= nrow(eqvrsus)
if (nvrs!=neqvrsus){
  cat(paste0(&ldquo;<strong><em>Number of records in vrs is not equal to eqvrsus</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vrs is  equal to eqvrsus&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>nvvrggeo= nrow(vvrggeo)
neqvvrggeous= nrow(eqvvrggeous)
if (nvvrggeo!=neqvvrggeous){
  cat(paste0(&ldquo;<strong><em>Number of records in vvrggeo is not equal to eqvvrggeous</em></strong>&rdquo;,&ldquo;\n&rdquo;))
} else {cat(paste0(&ldquo;Number of records in vvrggeo is  equal to eqvvrggeous&rdquo;,&ldquo;\n&rdquo;))}</p>

<p>cat(paste0(&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<p>cat(paste0(&ldquo;Checking vgeo table :&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h4>Check vgeo and eqvgeo tables</h4>

<p>cat(paste0(&ldquo;Check vgeo and eqvgeo tables :&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check for duplicates in postal codes</h1>

<p>vgeo_duplicates = data.table(sqlQuery(dbHandle, &ldquo;SELECT
                                                      POSTALCODE, COUNT(<em>)
                                                  FROM
                                                      vgeo
                                                  WHERE
                                                    POSTALCODE IS NOT NULL<br/>
                                                  GROUP BY
                                                       POSTALCODE 
                                                  HAVING 
                                                      COUNT(</em>) &gt; 1
                                                  &rdquo;))</p>

<p>nvgeo_duplicate=nrow(vgeo_duplicates)
cat(paste0(&ldquo;Numberof Duplicate Postalcodes =&rdquo;,nvgeo_duplicate,&ldquo;\n&rdquo;))
cat(paste0(&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,vgeo_duplicates))</p>

<h1>Check for duplicates in districts</h1>

<p>cat(paste0(&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))
vgeo_duplicates_dis = data.table(sqlQuery(dbHandle, &ldquo;SELECT
                                      Admin2Code, COUNT(<em>)
                                      FROM
                                      vgeo
                                      WHERE
                                      Admin2Code IS NOT NULL<br/>
                                      GROUP BY
                                      Admin2Code 
                                      HAVING 
                                      COUNT(</em>) &gt; 1
                                      &rdquo;))</p>

<p>nvgeo_duplicate_dis=nrow(vgeo_duplicates_dis)
cat(paste0(&ldquo;Numberof Duplicate Admin2Code (District) =&rdquo;,nvgeo_duplicate_dis,&ldquo;\n&rdquo;))
cat(paste0(&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,vgeo_duplicates_dis,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>check for number of distinct states</h1>

<p>nvgeo_admin1=data.table(sqlQuery(dbHandle, &ldquo;select COUNT(distinct Admin1Code) from vgeo&rdquo;))
cat(paste0(&ldquo;Numberof Distinct Admin1Code (States) =&rdquo;,nvgeo_admin1,&ldquo;\n&rdquo;))</p>

<p>#Check if records with the same GEO_RECNUM have the same values in vgeo and eqvgeous tables
#Check records with postal code</p>

<p>vgeo_Postal_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT vgeo.GEO_RECNUM, eqvgeous.GEO_RECNUM, vgeo.POSTALCODE,eqvgeous.POSTALCODE,vgeo.Admin1Code,eqvgeous.STATE,vgeo.Admin2Code,eqvgeous.COUNTYNUM
                                      FROM vgeo 
                                      INNER JOIN eqvgeous ON vgeo.GEO_RECNUM = eqvgeous.GEO_RECNUM and (vgeo.POSTALCODE!=eqvgeous.POSTALCODE and (vgeo.POSTALCODE IS NOT NULL and eqvgeous.POSTALCODE is NOT NULL))&rdquo;))</p>

<p>nvgeo_Postal_dif=nrow(vgeo_Postal_dif)
cat(paste0(&ldquo;Number of rows with unmatched postal codes =&rdquo;,nvgeo_Postal_dif,&ldquo;\n&rdquo;))</p>

<h1>Check records without postal code with unmatched state or district code</h1>

<p>vgeo_NoPostal_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT vgeo.GEO_RECNUM, eqvgeous.GEO_RECNUM, vgeo.POSTALCODE,eqvgeous.POSTALCODE,vgeo.Admin1Code,eqvgeous.STATE,vgeo.Admin2Code,eqvgeous.COUNTYNUM
                                      FROM vgeo 
                                      INNER JOIN eqvgeous ON vgeo.GEO_RECNUM = eqvgeous.GEO_RECNUM and (vgeo.POSTALCODE IS NULL and eqvgeous.POSTALCODE is NULL) and (vgeo.Admin1Code!=eqvgeous.STATE or vgeo.Admin2Code!=eqvgeous.COUNTYNUM)&rdquo;))</p>

<p>nvgeo_NoPostal_dif=nrow(vgeo_NoPostal_dif)
cat(paste0(&ldquo;Number of rows with unmatched state or district fields =&rdquo;,nvgeo_NoPostal_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check cghs and eqcghsus tables:   KEY cghs_ID</h1>

<p>cat(paste0(&ldquo;Check cghs and eqcghsus tables :&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check Hazard_type:</h1>

<p>cghs_haztype_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT cghs.HAZ_TYPE, eqcghsus.HAZ_TYPE
FROM cghs
     INNER JOIN eqcghsus ON eqcghsus.CGHS_ID=cghs.CGHS_ID and 
     eqcghsus.HAZ_TYPE!=(select Map_HazardType.haz_type from Map_HazardType where haz_type_id=cghs.HAZ_TYPE)
 &rdquo;))</p>

<p>ncghs_haztype_dif=nrow(cghs_haztype_dif)
cat(paste0(&ldquo;Numberof rows with unmatched hazard type =&rdquo;,ncghs_haztype_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check Hazard_Scale:</h1>

<p>cghs_hazscale_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT cghs.HAZ_SCALE, eqcghsus.HAZ_SCALE
                                                  FROM cghs
                                                       INNER JOIN eqcghsus ON eqcghsus.CGHS_ID=cghs.CGHS_ID and 
                                                       eqcghsus.HAZ_SCALE!=(select Map_HazardSCALE.haz_SCALE from Map_HazardSCALE where haz_SCALE_id=cghs.HAZ_SCALE)
                                                      &rdquo;))</p>

<p>ncghs_hazscale_dif=nrow(cghs_hazscale_dif)
cat(paste0(&ldquo;Numberof rows with unmatched hazard scale =&rdquo;,ncghs_hazscale_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check Coverage:</h1>

<p>cghs_Coverage_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT cghs.COVERAGE, eqcghsus.COVERAGE
                                                  FROM cghs
                                                       INNER JOIN eqcghsus ON eqcghsus.CGHS_ID=cghs.CGHS_ID and 
                                                       eqcghsus.COVERAGE!=(select Map_COVERAGE.coverage from Map_COVERAGE where COVERAGE_id=cghs.COVERAGE)
                                                     &rdquo;))</p>

<p>ncghs_Coverage_dif=nrow(cghs_Coverage_dif)
cat(paste0(&ldquo;Numberof rows with unmatched coverage =&rdquo;,ncghs_Coverage_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h4>Check Imap and eqimapus tables: KEY is  INV_RECNUM</h4>

<p>cat(paste0(&ldquo;Check Imap and eqimapus tables :&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check INV_KEY</h1>

<p>imap_invkey_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.INV_KEY, eqimapus.INV_KEY
                                                FROM imap
                                                     INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                     (eqimapus.INV_KEY!=(select Map_InvKey.inv_key from Map_InvKey where inv_key_id= imap.INV_KEY) or 
                                                     (eqimapus.INV_KEY is NULL and 
                                                     (select Map_InvKey.inv_key from Map_InvKey where inv_key_id= imap.INV_KEY)is not NULL))
                                                                                        &rdquo;))</p>

<p>nimap_invkey_dif=nrow(imap_invkey_dif)
cat(paste0(&ldquo;Numberof rows with unmatched INV_KEY =&rdquo;,nimap_invkey_dif,&ldquo;\n&rdquo;))</p>

<h1>Check MAPCCLSSIF</h1>

<p>imap_MAPCCLSSIF_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.MAPCCLSSIF, eqimapus.MAPCCLSSIF
                                                    FROM imap
                                                         INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                         (eqimapus.MAPCCLSSIF!=(select Map_MAPCCLSSIF.mapcclssif from Map_MAPCCLSSIF where mapcclssif_id= imap.MAPCCLSSIF)or
                                                         (eqimapus.MAPCCLSSIF is NULL and 
                                                         (select Map_MAPCCLSSIF.mapcclssif from Map_MAPCCLSSIF where mapcclssif_id= imap.MAPCCLSSIF)is not NULL))
                                                                                          &rdquo;))</p>

<p>nimap_MAPCCLSSIF_dif=nrow(imap_MAPCCLSSIF_dif)
cat(paste0(&ldquo;Numberof rows with unmatched MAPCCLSSIF =&rdquo;,nimap_MAPCCLSSIF_dif,&ldquo;\n&rdquo;))</p>

<h1>Check MAPCCTIER1</h1>

<p>imap_MAPCCTIER1_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.MAPCCTIER1, eqimapus.MAPCCTIER1
                                                    FROM imap
                                                         INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                         (eqimapus.MAPCCTIER1!=(select Map_MAPCCTier1.mapcctier1 from Map_MAPCCTier1 where mapcctier1_id= imap.MAPCCTIER1) or 
                                                         (eqimapus.MAPCCTIER1 is NULL and 
                                                         (select Map_MAPCCTier1.mapcctier1 from Map_MAPCCTier1 where mapcctier1_id= imap.MAPCCTIER1)is not NULL))
                                          &rdquo;))</p>

<p>nimap_MAPCCTIER1_dif=nrow(imap_MAPCCTIER1_dif)
cat(paste0(&ldquo;Numberof rows with unmatched MAPCCTIER1 =&rdquo;,nimap_MAPCCTIER1_dif,&ldquo;\n&rdquo;))</p>

<h1>Check MAPCCTIER2</h1>

<p>imap_MAPCCTIER2_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.MAPCCTIER2, eqimapus.MAPCCTIER2
                                          FROM imap
                                          INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                          (eqimapus.MAPCCTIER2!=(select Map_MAPCCTIER2.MAPCCTIER2 from Map_MAPCCTIER2 where MAPCCTIER2_id= imap.MAPCCTIER2) or 
                                          (eqimapus.MAPCCTIER2 is NULL and 
                                          (select Map_MAPCCTIER2.MAPCCTIER2 from Map_MAPCCTIER2 where MAPCCTIER2_id= imap.MAPCCTIER2)is not NULL))
                                          &rdquo;))</p>

<p>nimap_MAPCCTIER2_dif=nrow(imap_MAPCCTIER2_dif)
cat(paste0(&ldquo;Numberof rows with unmatched MAPCCTIER2 =&rdquo;,nimap_MAPCCTIER2_dif,&ldquo;\n&rdquo;))</p>

<h1>Check MAPCCTIER3</h1>

<p>imap_MAPCCTIER3_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.MAPCCTIER3, eqimapus.MAPCCTIER3
                                          FROM imap
                                          INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                          (eqimapus.MAPCCTIER3!=(select Map_MAPCCTIER3.MAPCCTIER3 from Map_MAPCCTIER3 where MAPCCTIER3_id= imap.MAPCCTIER3) or 
                                          (eqimapus.MAPCCTIER3 is NULL and 
                                          (select Map_MAPCCTIER3.MAPCCTIER3 from Map_MAPCCTIER3 where MAPCCTIER3_id= imap.MAPCCTIER3)is not NULL))
                                          &rdquo;))</p>

<p>nimap_MAPCCTIER3_dif=nrow(imap_MAPCCTIER3_dif)
cat(paste0(&ldquo;Numberof rows with unmatched MAPCCTIER3 =&rdquo;,nimap_MAPCCTIER3_dif,&ldquo;\n&rdquo;))</p>

<h1>Check INVOCC</h1>

<p>imap_INVOCC_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.INV_OCC, eqimapus.INV_OCC
                                                FROM imap
                                                     INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                     (eqimapus.INV_OCC!=(select Map_InvOcc.inv_occ from Map_InvOcc where inv_occ_id= imap.INV_OCC) or 
                                                     (eqimapus.INV_OCC is NULL and 
                                                     (select Map_InvOcc.inv_occ from Map_InvOcc where inv_occ_id= imap.INV_OCC)is not NULL))
                                          &rdquo;))</p>

<p>nimap_INVOCC_dif=nrow(imap_INVOCC_dif)
cat(paste0(&ldquo;Numberof rows with unmatched INVOCC =&rdquo;,nimap_INVOCC_dif,&ldquo;\n&rdquo;))</p>

<h1>Check CV_KEY</h1>

<p>imap_CV_KEY_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.CV_KEY, eqimapus.CV_KEY
                                                FROM imap
                                                     INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                     (eqimapus.CV_KEY!=(select Map_CvKey.cv_key from Map_CvKey where cv_key_id= imap.CV_KEY) or 
                                                     (eqimapus.CV_KEY is NULL and 
                                                     (select Map_CvKey.cv_key from Map_CvKey where cv_key_id= imap.CV_KEY)is not NULL))
                                      &rdquo;))</p>

<p>nimap_CV_KEY_dif=nrow(imap_CV_KEY_dif)
cat(paste0(&ldquo;Numberof rows with unmatched CV_KEY =&rdquo;,nimap_CV_KEY_dif,&ldquo;\n&rdquo;))</p>

<h1>Check BR_TVKEY</h1>

<p>imap_BR_TVKEY_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.BR_TVKEY, eqimapus.BR_TVKEY
                                                  FROM imap
                                                       INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                       (eqimapus.BR_TVKEY!=(select Map_BRTVKey.br_tvkey from Map_BRTVKey where br_tvkey_id= imap.BR_TVKEY) or 
                                                       (eqimapus.BR_TVKEY is NULL and 
                                                       (select Map_BRTVKey.br_tvkey from Map_BRTVKey where br_tvkey_id= imap.BR_TVKEY)is not NULL))
                                      &rdquo;))</p>

<p>nimap_BR_TVKEY_dif=nrow(imap_BR_TVKEY_dif)
cat(paste0(&ldquo;Numberof rows with unmatched BR_TVKEY =&rdquo;,nimap_BR_TVKEY_dif,&ldquo;\n&rdquo;))</p>

<h1>Check BR_DRKEY</h1>

<p>imap_BR_DRKEY_dif = data.table(sqlQuery(dbHandle,&ldquo;SELECT imap.BR_DRKEY, eqimapus.BR_DRKEY
                                                  FROM imap
                                                       INNER JOIN eqimapus ON eqimapus.INV_RECNUM=imap.INV_RECNUM and 
                                                       (eqimapus.BR_DRKEY!=(select Map_BRDRKey.br_drkey from Map_BRDRKey where br_drkey_id= imap.BR_DRKEY) or 
                                                       (eqimapus.BR_DRKEY is NULL and 
                                                       (select Map_BRDRKey.br_drkey from Map_BRDRKey where br_drkey_id= imap.BR_DRKEY)is not NULL))
                                        &rdquo;))</p>

<p>nimap_BR_DRKEY_dif=nrow(imap_BR_DRKEY_dif)
cat(paste0(&ldquo;Numberof rows with unmatched BR_DRKEY =&rdquo;,nimap_BR_DRKEY_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h4>Check vinv and eqvinvus tables KEy: INV_RECNUM and PDC_NUM and PDC_GROUP</h4>

<p>cat(paste0(&ldquo;Check  vinv and eqvinvus tables :&rdquo;,&ldquo;\n&rdquo;))</p>

<p>inv_dif = data.table(sqlQuery(dbHandle,&ldquo; SELECT vinv.INV_RECNUM,vinv.PDC_GROUP,vinv.PDC_NUM, eqvinvus.INV_RECNUM,eqvinvus.PDC_GROUP,eqvinvus.PDC_NUM 
                                         FROM vinv 
                                         INNER JOIN eqvinvus ON (vinv.INV_RECNUM= eqvinvus.INV_RECNUM and vinv.PDC_GROUP=eqvinvus.PDC_GROUP and vinv.PDC_NUM =eqvinvus.PDC_NUM) 
                                          and ((ROUND(vinv.DEF_INVPCT,0)!=ROUND(eqvinvus.DEF_INVPCT,0) 
                                          or (ROUND(vinv.CT,4)!=ROUND(eqvinvus.CT,4))) 
                                          or (vinv.AVGSTHT!=eqvinvus.AVGSTHT) or (vinv.DNUMSTOR!=eqvinvus.DNUMSTOR))
                                                                      &rdquo;))</p>

<p>ninv_dif=nrow(inv_dif)
cat(paste0(&ldquo;Number of unmatched rows= &rdquo;,ninv_dif,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<p>####### TEST vdc0</p>

<p>SELECT COUNT(distinct(CGHS_ID)) FROM vdc0 </p>

<p>SELECT distinct(CGHS_ID) FROM vdc0 </p>

<h4>check if all damage curves are monotonic (increasing) Stard with the DC_NUM then DC_KEY then CGHS_ID</h4>

<h1>PDC_NUM = data.table(sqlQuery(dbHandle,&ldquo;SELECT distinct(PDC_NUM) FROM vdc0&rdquo;))</h1>

<h1>nPDC_NUM = nrow(PDC_NUM)</h1>

<h1>DC_KEY = data.table(sqlQuery(dbHandle,&ldquo;SELECT distinct(DC_KEY) FROM vdc0&rdquo;))</h1>

<h1>nDC_KEY = nrow(DC_KEY)</h1>

<h1>CGHS_ID = data.table(sqlQuery(dbHandle,&ldquo;SELECT distinct(CGHS_ID) FROM vdc0&rdquo;))</h1>

<h1>nCGHS_ID = nrow(CGHS_ID)</h1>

<h1>Check if all damage curves are monotonically increasing</h1>

<p>vdcD &lt;- vdc0[,.(difference = diff(DAMAGE_PCT)),by=c(&ldquo;PDC_NUM&rdquo;,&ldquo;dc_key&rdquo;,&ldquo;CGHS_ID&rdquo;)]
nvdcD=nrow(vdcD[difference&lt;0])</p>

<p>cat(paste0(&ldquo;Number of damage curves which are not motonically increasing= &rdquo;,nvdcD,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check if the x-axis on damage curves are motonically increasing</h1>

<p>vdcDHaz &lt;- vdc0[,.(difference=diff(HAZ_SEV)),by=c(&ldquo;PDC_NUM&rdquo;,&ldquo;dc_key&rdquo;,&ldquo;CGHS_ID&rdquo;)]</p>

<p>nvdcDHaz=nrow(vdcDHaz[difference&lt;0])</p>

<p>cat(paste0(&ldquo;Number of damage curves in which x-axis is not motonically increasing= &rdquo;,nvdcD,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;,&ldquo;\n&rdquo;))</p>

<h1>Check if curves with the same CGHS_ID have the same number or records.</h1>

<p>Frequency=data.table(sqlQuery(dbHandle,&ldquo;<br/>
SELECT DC_KEY, PDC_NUM, CGHS_ID, COUNT(*) as Freq
FROM vdc0
GROUP BY  DC_KEY, PDC_NUM, CGHS_ID 
&rdquo;))</p>

<p>Freq_Diff=Frequency[,.(difference=diff(Freq)),by=c(&ldquo;CGHS_ID&rdquo;)]
nFreq_Diff=nrow(Freq_Diff[difference!=0])</p>

<p>cghs_ID_Distinct = data.table(sqlQuery(dbHandle,&ldquo;SELECT distinct(CGHS_ID) FROM vdc0&rdquo;)) # Makes a table of distinct cghs_ID exist in vdc0 table 
cghs_ID_Distinct=cghs_ID_Distinct[order(CGHS_ID)] # Sort the table 
ncghs_ID_Distinct=nrow(cghs_ID_Distinct)</p>

<h1>for each cghs_ID the number of rows in eqvhazus database should be constant</h1>

<p>nDC_KEY_Distinct = data.table(sqlQuery(dbHandle,paste(&ldquo;SELECT COUNT(distinct(DC_KEY)) FROM eqvhazus where CGHS_ID=&rdquo;,toString(7))))</p>

<p>######## TEST AREA :D</p>

<p>DC_Map&lt;- function (x){</p>

<p>return(Map_DCKey[dc_key_id==x,dc_key])
}</p>

<p>d=Sys.time()</p>

<p>print(d-c)</p>

<p>closeAllConnections() # it closes the connection to the file so it writes on the console.</p>

</body>

</html>
